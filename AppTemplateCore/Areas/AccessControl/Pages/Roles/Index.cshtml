@page
@model IndexModel

@{
    ViewData["Title"] = "Roles List";
}

<partial name="_StatusMessage" for="StatusMessage" />

<h1>@ViewData["Title"]</h1>

<p>
    @*Show Page by calling OnGet() both page at same level *@
    <a asp-page="Create" class="btn btn-primary">Add Role</a>
</p>

@{
    if (Model.Input.Count() <= 0)
    {
        <p>No Role Found</p>
        return;
    }
}


<table id="roles" class="table table-bordered table-hover">
    <thead>
        <tr>
            <th>Roles</th>
            <th>Details</th>
            <th>Users</th>
            <th>Edit</th>
            <th>Delete by Get </th>
            <th>Delete by Post </th>
            <th>Delete by Post </th>
            <th>Delete by Post</th>
            <th>2 Step Delete</th>
            <th>Add Users</th>
        </tr>
    </thead>
    <tbody>

        @foreach (var role in Model.Input)
        {
            <tr>

                <td>
                    <a asp-page="./Details" asp-route-id="@role.Id"> @role.Name</a>
                </td>

                <td>
                    <a asp-page="./Details" asp-route-id="@role.Id" class="btn btn-primary">Details</a>
                </td>

                <td>
                    @if (role.UserList != null && role.UserList.Count >= 1)
                    {
                        string userlist = string.Empty;
                        foreach (var user in role.UserList)
                        {
                            userlist = userlist + user.UserName + ", ";
                        }
                        <p>@userlist</p>
                    }
                    else
                    {
                        <p>Role not assigned</p>
                    }
                </td>

                <td>
                    <a asp-page="./Edit" asp-route-id="@role.Id" class="btn btn-primary">Edit</a>
                </td>

                <td>
                    @*Delete by Get, not to use in real, just for demo*@
                    <a asp-page-handler="Delete" asp-route-id="@role.Id" class="btn btn-danger">Delete</a>
                </td>

                <td>
                    @*Delete by Post, dialog box confirmation*@
                    <form method="post" asp-route-id="@role.Id">

                        <input type="submit" value="Delete" class="btn btn-danger" />

                    </form>
                </td>

                <td>
                    @*Delete by Post, inline confirmation*@
                    <form method="post" asp-route-id="@role.Id">

                        <span id="confirmDeleteSpan_@role.Id" style="display:none">

                            <span>Are you sure you want to delete?</span>

                            <button type="submit" class="btn btn-danger">Yes</button>

                            <a href="#" class="btn btn-primary"
                               onclick="confirmDelete('@role.Id', false)">No</a>

                        </span>

                        <span id="deleteSpan_@role.Id">
                            <a href="#" class="btn btn-danger"
                               onclick="confirmDelete('@role.Id', true)">Delete</a>
                        </span>

                    </form>
                </td>


                <td>
                    @*Delete by Post, modal confirmation*@

                    @*<form method="post" asp-page-handler="Delete" asp-route-id="@role.Id">
                            <input type="submit" value="Del" onclick="return ConfirmDeleteDialog('@role.Id');" class="btn btn-danger" />
                        </form>*@

                    @*<form method="post" asp-page-handler="Delete" asp-route-id="@role.Id" >
                            <input type="submit" value="Del"  class="btn btn-danger" onclick="return confirm('Are youbbb sure you want to delete this?')" />
                        </form>*@

                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                        Open modal
                    </button>

                </td>



                <td>
                    @*Two step delete by seperate delete page *@
                    <a asp-page="./Delete" asp-route-id="@role.Id" class="btn btn-danger">Delete</a>
                </td>

                <td>
                    @Html.ActionLink("Add Users", "List", "RolesUsers", routeValues: new { userid = role.Id }, htmlAttributes: new { id = "roleDeleteLink", @class = "btn btn-primary" })
                </td>

            </tr>

        }

    </tbody>
</table>


<!-- The Modal -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Modal Heading</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    Modal body..
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger">Delete</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                </div>

            </div>
        </div>
    </div>


@section Scripts {

    <script src="~/js/ConfirmDelete.js"></script>
    <script src="~/lib/popper.js/popper.js"></script>

    <script>
        function ConfirmDeleteDialog(Id) {

            return confirm('Are you555555 sure you want to delete this?');
            //confirm('uuuuuuuuuuuuuuuuuu'+Id);
            //return false;
        }
    </script>

}